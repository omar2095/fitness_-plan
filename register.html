<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title id="registerPageTitle">Fitness Program - Register</title>
    <meta name="keywords" content="fitnessPlan, fitness, gym, calories" />
    <meta name="author" content="Omar Ahmed" />
    <link rel="icon" type="image/x-icon" href="assets/icon.png" />
    <link rel="stylesheet" href="assets/styles.css" />
  </head>
  <body>
    <!-- Top Controls -->
    <div class="top-controls">
      <button
        class="control-btn lang-btn"
        id="langToggle"
        onclick="toggleLanguage()"
      >
        EN
      </button>
      <button
        class="control-btn theme-btn"
        id="themeToggle"
        onclick="toggleTheme()"
      >
        ☀️
      </button>
    </div>

    <div class="container table-responsive">
      <div class="container" id="registrationContainer">
        <div class="section">
          <h2 id="registerTitle"></h2>
          <form id="registerForm">
            <div class="form-group">
              <label id="registerEmailLabel"></label>
              <input type="email" id="regEmail" required />
              <div class="error" id="emailError" style="display: none"></div>
            </div>
            <div class="form-group">
              <label id="registerPasswordLabel"></label>
              <input type="password" id="regPassword" required />
            </div>
            <button type="submit" class="btn" id="registerButton"></button>
          </form>
          <div
            id="registrationSuccess"
            style="display: none; color: green"
          ></div>

          <p style="text-align: center; margin-top: 15px">
            <a href="login.html" id="loginLink"
              >Already have an account? Login here / لديك حساب بالفعل؟ تسجيل
              الدخول هنا</a
            >
          </p>
          <p style="text-align: center; margin-top: 15px">
            <a href="login.html"></a>
          </p>
        </div>
      </div>
    </div>

    <div
      id="dateTime"
      style="
        text-align: center;
        margin-top: 15px;
        font-size: 12px;
        color: #7f8c8d;
      "
    ></div>

    <script src="assets/main.js"></script>
    <script>
      let users = JSON.parse(localStorage.getItem("users")) || [];
      let registeredEmails =
        JSON.parse(localStorage.getItem("registeredEmails")) || [];
      // Handle registration form submission
      document
        .getElementById("registerForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const email = document.getElementById("regEmail").value;
          const password = document.getElementById("regPassword").value;

          // Check if email already exists
          if (registeredEmails.includes(email)) {
            document.getElementById("emailError").style.display = "block";
            return;
          } // Add new user
          const newUser = {
            email: email,
            password: password,
            hasCompletedInfo: false,
          };

          users.push(newUser);
          registeredEmails.push(email);

          // Save to localStorage
          localStorage.setItem("users", JSON.stringify(users));
          localStorage.setItem(
            "registeredEmails",
            JSON.stringify(registeredEmails)
          );
          localStorage.setItem("currentUser", JSON.stringify(newUser));

          // Show success message
          document.getElementById("registrationSuccess").style.display =
            "block";

          // Redirect to basic info page
          setTimeout(() => {
            window.location.href = "basic-info.html";
          }, 1500);
        });
    </script>
  </body>
</html>
